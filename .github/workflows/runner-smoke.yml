name: Runner Smoke Test (h100-cr_0)

on:
  workflow_dispatch:

jobs:
  smoke:
    runs-on: [self-hosted, h100-cr_0]
    timeout-minutes: 20

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Basic info
        run: |
          set -euxo pipefail
          echo "Runner: $RUNNER_NAME"
          uname -a
          df -h
          free -h || true
          python3 --version || true

      - name: NVIDIA sanity
        run: |
          set -euxo pipefail
          nvidia-smi

      - name: Docker sanity
        run: |
          set -euxo pipefail
          docker --version
          docker info

      - name: Minimal container run
        run: |
          set -euxo pipefail
          docker run --rm ubuntu:22.04 bash -lc 'echo hello-from-container; cat /etc/os-release'
